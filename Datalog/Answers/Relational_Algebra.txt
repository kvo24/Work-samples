### Part 1: Warm Up with Relational Algebra

1. Write the equivalent SQL query to this relational algebra plan: figs/ra.pdf.


/*** ANSWER ***/

with living_grandparents as (
    select *
    from person_living p, parent_child c, (select p1 as p3, p2 as p4 
                                           from parent_child) d
    where p.x = c.p1 and c.p2 = d.p3
)
select p1, max(y) as z
from (select p1, p3, count(*) as y
      from living_grandparents
      group by p1, p3)
group by p1


/*** EXPLANATION ***/

GREEK SYMBOLS
Gamma: group-by
Theta: join
Rho: rename
Pi: project
Sigma: select

TABLES
person_living(x): lists living persons
parent_child(p1, p2): lists parent-child pairs

OPERATIONS
1. join person_living and parent_child on x = p1:
    finds parent_child tuples whose parent is living
2. rename parent_child attributes p3, p4
3. join (1) and (2) on p2 = p3:
    finds children from (1) who themselves have children
    living grandparents
4. group by p1, p3, count(*):
    for every unique living grandparent-parent combo, 
    count the number of grandchildren (= y)
5. group by p1, max(y):
    for each living grandparent, calculate the child (parent)
    who gave them the most number of grandchildren, and
    report that max number (= z)
=> We find, for every living grandparent, a number that represents
   the maximum number of grandchildren provided to them by any single
   child of theirs.
